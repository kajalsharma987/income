<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Official Certificate - Fixed</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
      body {
        background: #444;
        margin: 0;
        padding: 20px;
        font-family: "Times New Roman", Times, serif;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .no-print {
        background: #fff;
        padding: 10px;
        margin-bottom: 20px;
        width: 210mm;
        display: flex;
        justify-content: center;
        border-radius: 4px;
      }
      #certificate {
        width: 210mm;
        height: 297mm;
        background: white;
        padding: 10mm 15mm;
        box-sizing: border-box;
        position: relative;
        color: #000;
      }
      .header-wrap {
        display: flex;
        border-bottom: 1.5px solid #000;
        padding-bottom: 6px;
        margin-bottom: 10px;
      }
      .header-content {
        flex-grow: 1;
        text-align: center;
        padding-right: 55px;
      }
      .header-content p {
        margin: 0;
        font-size: 14px;
        font-weight: bold;
      }
      .header-content h2 {
        margin: 1px 0;
        font-size: 19px;
      }

      .meta-container {
        display: flex;
        justify-content: space-between;
        margin-top: 15px;
        font-size: 13.5px;
      }
      /* Barcode fix for PDF */
      .barcode-box {
        margin-top: 5px;
      }
      .barcode-svg {
        width: 180px;
        height: 35px;
        border: 0.5px solid #000;
      }
      .barcode-img {
        width: 120px; /* barcode ki width */
        height: 30px; /* barcode ki height (mota look) */
        display: block;
        margin-top: 2px;
      }

      .barcode-number {
        display: block;
        width: 120px; /* SAME as barcode */
        text-align: center;
        /* text: bold; */
        font-size: 12.5px;
        /* letter-spacing: 2px; */
        margin-top: 2px;
      }

      .app-side {
        text-align: right;
        line-height: 1.3;
        font-size: 13.5px;
      }
      .app-side div {
        margin-bottom: 6px;
      }

      .title-block {
        text-align: center;
        margin: 25px 0;
      }
      .title-block h1 {
        font-size: 16px;
        text-decoration: underline;
        font-weight: bold;
      }

      .middle-section {
        font-size: 14.5px;
        line-height: 1.9;
        margin-top: 5px;
      }
      .row {
        display: flex;
        align-items: baseline;
        margin-bottom: 6px;
      }
      .editable {
        outline: none;
        font-weight: bold;
        text-transform: uppercase;
        cursor: text;
        padding: 0 3px;
      }
      .eng-para {
        margin-top: 25px;
        text-align: justify;
        line-height: 1.7;
        font-size: 14px;
      }

      /* Pure footer area ko manage karne ke liye */
      .footer-wrap {
        display: flex;
        justify-content: space-between; /* QR ko left aur Signature ko right bhejne ke liye */
        align-items: flex-end; /* Dono ko bottom se align rakhega */
        font-family: Arial, sans-serif;
        padding: 20px;
        width: 100%;
      }

      #qr-box {
        width: 100px; /* QR code ka size yahan adjust karein */
        height: 100px;
        background-color: #eee; /* Sirf placeholder ke liye */
      }

      .sig-section {
        text-align: left; /* Text khud left-aligned rahega lekin box right mein hoga */
      }

      .sig-auth-title {
        font-size: 15px;
        display: block;
        margin-bottom: 10px;
      }

      .sig-container {
        display: flex;
        align-items: flex-start;
      }

      .sig-valid-text {
        font-size: 14px;
        /* font-weight: bold; */
        display: block;
      }

      .sig-details {
        font-size: 7px;
        line-height: 1.2;
      }

      .green-tick {
        height: 60px;
        margin-left: -5px; /* Tick ko details ke sath overlap karne ke liye */
        margin-top: 5px;
      }

      .notes-area {
        margin-top: 30px;
        /* Line removed as requested */
        padding-top: 5px;
      }
      .csc-footer {
        position: absolute;
        bottom: 12mm;
        width: 80%;
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        font-style: italic;
      }

      @media print {
        .no-print {
          display: none;
        }
        body {
          background: #fff;
          padding: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="no-print">
      <!-- <button
        onclick="savePDF()"
        style="
          padding: 10px 20px;
          background: #000;
          color: #fff;
          border: none;
          cursor: pointer;
          font-weight: bold;
        "
      >
        DOWNLOAD FINAL PDF
      </button> -->
    </div>

    <div id="certificate">
      <div class="header-wrap">
        <div style="width: 70px">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Emblem_of_India.svg/800px-Emblem_of_India.svg.png"
            style="width: 60px"
          />
        </div>
        <div class="header-content">
          <p>অসম চৰকাৰ</p>
          <h2>GOVERNMENT OF ASSAM</h2>
          <p>চক্ৰ বিষয়া কাৰ্যালয়</p>
          <p>
            OFFICE OF THE CIRCLE OFFICER<br />
            <span class="editable" data-field="circle" contenteditable="false"
              >TINSUKIA</span
            >
          </p>
          <!-- <br /> -->
          <p>TINSUKIA DISTRICT</p>
          <!-- <br/> -->
          <p>(Assam e-District Project)</p>
        </div>
      </div>

      <div class="meta-container">
        <div class="barcode-side">
          প্ৰমাণ পত্ৰ নং <br />
          Certificate No. :
          <span class="editable" id="certNo" contenteditable="false"
            >12122025-001-15682285</span
          ><br /><br />

          <div class="barcode-box">
            <img src="barcode.png" class="barcode-img" />
          </div>

          <span
            class="editable barcode-number"
            id="certNoBarcode"
            contenteditable="true"
          >
            1212202500115682285
          </span>
        </div>
        <div class="app-side">
          <div>আবেদন নং</div>
          <div>
            Application No. :
            <span class="editable" id="appNo" contenteditable="false">
              SSDG/ED/INC/109435568
            </span>
          </div>
          <div>
            তাৰিখ / Date:
            <span class="editable" id="issueDate" contenteditable="false"
              >12-12-2025</span
            >
          </div>
        </div>
      </div>

      <div class="title-block">
        <p style="font-size: 14px; margin: 0">বার্ষিক আয়ৰ প্ৰমাণ পত্ৰ</p>
        <h1>ANNUAL INCOME CERTIFICATE</h1>
      </div>

      <div class="middle-section">
        <div class="row">
          <span>ইয়াৰ দ্বাৰা প্ৰমাণ পত্ৰ দিয়া হ'ল যে</span>
          <div style="flex-grow: 1; text-align: center">
            <span class="editable" id="personName" contenteditable="false"
              >PAVAN KUMAR</span
            >
          </div>
          <span>ব পুত্ৰ / কন্যা / পত্নী / স্বামী</span>
        </div>
        <div class="row">
          <div style="width: 320px; text-align: center">
            <span class="editable" id="fatherName" contenteditable="false"
              >SUKHVIR SINGH</span
            >
          </div>
          <span>গাঁও/ নগৰ:</span>
          <div style="flex-grow: 1; text-align: center">
            <span class="editable" id="village" contenteditable="false"
              >NOWSALIA GAON</span
            >
          </div>
        </div>
        <div class="row" style="justify-content: space-between">
          <div>
            মৌজা :
            <span class="editable" id="mouza" contenteditable="false"
              >RONGAGORA</span
            >
          </div>
          <div>
            চক্ৰ :
            <span class="editable" id="circle" contenteditable="false"
              >TINSUKIA</span
            >
          </div>
          <div>
            জিলা :
            <span class="editable" id="district" contenteditable="false"
              >JORHAT</span
            >
          </div>
        </div>
        <div class="row">
          <span>মুঠ বার্ষিক আয়</span>
          <div style="flex-grow: 1; text-align: center">
            <span class="editable" id="incomeSource" contenteditable="false"
              >CULTIVATION</span
            >
          </div>
          <span
            >ৰ পৰা Rs.
            <span class="editable" id="amount" contenteditable="false"
              >3,00,000</span
            ></span
          >
        </div>
        <div class="row">
          <span
            >(Rupees
            <span class="editable" id="amountWords" contenteditable="false"
              >Three Lakh</span
            >
            ) only</span
          >
          <div style="flex-grow: 1; text-align: right">টকা হয়।</div>
        </div>

        <div class="eng-para">
          This is to certify that
          <b
            ><span class="editable" contenteditable="false"
              >PAVAN KUMAR</span
            ></b
          >
          son/ daughter/ wife/ husband of
          <b
            ><span class="editable" contenteditable="false"
              >SUKHVIR SINGH</span
            ></b
          >
          Village / Town
          <b
            ><span class="editable" contenteditable="false"
              >NOWSALIA GAON</span
            ></b
          >
          Mouza
          <b
            ><span class="editable" data-field="mouza" contenteditable="false"
              >RONGAGORA</span
            ></b
          >
          Circle
          <b
            ><span class="editable" data-field="circle" contenteditable="false"
              >TINSUKIA</span
            ></b
          >
          District
          <b
            ><span
              class="editable"
              data-field="district"
              contenteditable="false"
              >JORHAT</span
            ></b
          >
          whose total annual income from
          <b
            ><span class="editable" contenteditable="false"
              >CULTIVATION</span
            ></b
          >
          is Rs.
          <b
            ><span class="editable" data-field="amount" contenteditable="false"
              >3,00,000</span
            ></b
          >
          (Rupees
          <b
            ><span class="editable" data-field="words" contenteditable="false"
              >Three Lakh</span
            ></b
          >) only.
        </div>
        <div style="margin-top: 25px; font-size: 14px; line-height: 1.6">
          এই প্ৰমাণ পত্ৰ সংশ্লিষ্ট এল এমৰ প্ৰতিবেদন ভিত্তিত প্ৰদান কৰা হ'ল /
          This certificate is issued on the basis of concerned L.M's report.

          <br /><br />

          This certificate is valid for one year from the date of issue
        </div>
      </div>
      <div class="footer-wrap">
        <div id="qr-box">
          <!-- <img src="qr_code_image.png" alt="QR Code" style="width: 100%" /> -->
        </div>

        <div class="sig-section">
          <span class="sig-auth-title">Signature of Approving Authority</span>

          <div class="sig-container">
            <div class="text-side">
              <span class="sig-valid-text">Signature Not Verified</span>
              <div class="sig-details">
                Digitally Signed.<br />
                Name:
                <span class="editable" contenteditable="false"
                  >KRITIKA SARMAH</span
                ><br />
                Date:
                <span class="editable" contenteditable="false"
                  >12-Dec-2025 12:41:45</span
                ><br />
                Reason: eDistrict<br />
                Location: Assam
              </div>
            </div>
            <img src="question.jpg" class="green-tick" alt="Valid" />
          </div>
        </div>
      </div>

      <div class="notes-area">
        <span
          style="
            font-weight: bold;
            text-decoration: underline;
            font-size: 12.5px;
          "
          >NOTE :</span
        >
        <ol
          style="
            font-size: 11.5px;
            font-style: italic;
            line-height: 1.6;
            margin: 5px 0 0 15px;
            padding: 0;
          "
        >
          <li>
            This certificate is digitally signed and therefore needs no physical
            signature.
          </li>
          <li>
            Authenticity can be verified from
            http://www.assam.gov.in/certificate-verification.
          </li>
          <li>
            This certificate is legally valid as per the Information Technology
            Act 2000.
          </li>
          <li>Tampering of this certificate will attract penal action.</li>
        </ol>
      </div>

      <div class="csc-footer">
        <div>
          CSC Name :
          <span class="editable" contenteditable="false"
            >Tinsukia,SRIPURIA TINGRAI</span
          >
        </div>
        <div>
          CSC ID :
          <span class="editable" contenteditable="false">AS247123630012</span>
        </div>
      </div>
    </div>
    <script>
      function applyData(data) {
        if (!data) return;

        const idMap = {
          certNo: "certNo",
          appNo: "appNo",
          date: "issueDate",
          name: "personName",
          father: "fatherName",
          village: "village",
          mouza: "mouza",
          circle: "circle",
          district: "district",
          income: "incomeSource",
          amount: "amount",
          words: "amountWords",
        };

        Object.keys(idMap).forEach((key) => {
          const val = data[key];
          const id = idMap[key];
          if (val && document.getElementById(id)) {
            document.getElementById(id).innerText = val;
          }
        });

        Object.keys(idMap).forEach((key) => {
          const val = data[key];
          if (!val) return;
          document
            .querySelectorAll(`[data-field="${key}"]`)
            .forEach((el) => (el.innerText = val));
        });

        const certNo = data.certNo || "";
        const barcodeDigits = certNo.replace(/[^0-9]/g, "");
        const barcodeEl = document.getElementById("certNoBarcode");
        if (barcodeEl && barcodeDigits) {
          barcodeEl.innerText = barcodeDigits;
        }
      }

      function generateQR() {
        const qrContainer = document.getElementById("qr-box");
        if (!qrContainer) return;
        qrContainer.innerHTML = "";
        new QRCode(qrContainer, {
          text: window.location.href,
          width: 100,
          height: 100,
          correctLevel: QRCode.CorrectLevel.M,
        });
      }

      function savePDF() {
        const element = document.getElementById("certificate");
        const nameEl = document.getElementById("personName");
        const safeName = nameEl
          ? nameEl.innerText.trim().replace(/[^a-zA-Z0-9_-]+/g, "_")
          : "Certificate";
        const opt = {
          margin: 0,
          filename: `Verified_${safeName}.pdf`,
          image: { type: "jpeg", quality: 0.98 },
          html2canvas: { scale: 2 },
          pagebreak: { mode: ["avoid-all", "css", "legacy"] },
          jsPDF: { unit: "mm", format: "a4", orientation: "portrait" },
        };
        html2pdf().set(opt).from(element).save();
      }

      window.onload = function () {
        const params = new URLSearchParams(window.location.search);
        const rawData = params.get("data");

        if (rawData) {
          const data = JSON.parse(decodeURIComponent(rawData));
          applyData(data);
        }

        generateQR();
        setTimeout(savePDF, 500);
      };
    </script>
  </body>
</html>
